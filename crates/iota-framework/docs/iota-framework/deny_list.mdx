---
title: Module `0x2::deny_list`
---
import Link from '@docusaurus/Link';

<Link id="0x2_deny_list"/>
Defines the <code>
<Link to="../iota-framework/deny_list#0x2_deny_list_DenyList">DenyList</Link></code> type. The <code>
<Link to="../iota-framework/deny_list#0x2_deny_list_DenyList">DenyList</Link></code> shared object is used to restrict access to
instances of certain core types from being used as inputs by specified addresses in the deny
list.


-  [Resource `DenyList`](#0x2_deny_list_DenyList)
-  [Resource `PerTypeList`](#0x2_deny_list_PerTypeList)
-  [Constants](#@Constants_0)
-  [Function `add`](#0x2_deny_list_add)
-  [Function `per_type_list_add`](#0x2_deny_list_per_type_list_add)
-  [Function `remove`](#0x2_deny_list_remove)
-  [Function `per_type_list_remove`](#0x2_deny_list_per_type_list_remove)
-  [Function `contains`](#0x2_deny_list_contains)
-  [Function `per_type_list_contains`](#0x2_deny_list_per_type_list_contains)
-  [Function `create`](#0x2_deny_list_create)
-  [Function `per_type_list`](#0x2_deny_list_per_type_list)


<pre><code>
<b>use</b> <Link to="../iota-framework/bag#0x2_bag">0x2::bag</Link>;
<b>use</b> <Link to="../iota-framework/object#0x2_object">0x2::object</Link>;
<b>use</b> <Link to="../iota-framework/table#0x2_table">0x2::table</Link>;
<b>use</b> <Link to="../iota-framework/transfer#0x2_transfer">0x2::transfer</Link>;
<b>use</b> <Link to="../iota-framework/tx_context#0x2_tx_context">0x2::tx_context</Link>;
<b>use</b> <Link to="../iota-framework/vec_set#0x2_vec_set">0x2::vec_set</Link>;
</code></pre>



<Link id="0x2_deny_list_DenyList"></Link>

## Resource `DenyList`

A shared object that stores the addresses that are blocked for a given core type.


<pre><code>
<b>struct</b> <Link to="../iota-framework/deny_list#0x2_deny_list_DenyList">DenyList</Link> <b>has</b> key
</code></pre>



<details>
<summary>Fields</summary>


<dl>
<dt>
<code>
id: <Link to="../iota-framework/object#0x2_object_UID">object::UID</Link></code>
</dt>
<dd>

</dd>
<dt>
<code>
lists: <Link to="../iota-framework/bag#0x2_bag_Bag">bag::Bag</Link></code>
</dt>
<dd>
 The individual deny lists.
</dd>
</dl>


</details>

<Link id="0x2_deny_list_PerTypeList"></Link>

## Resource `PerTypeList`

Stores the addresses that are denied for a given core type.


<pre><code>
<b>struct</b> <Link to="../iota-framework/deny_list#0x2_deny_list_PerTypeList">PerTypeList</Link> <b>has</b> store, key
</code></pre>



<details>
<summary>Fields</summary>


<dl>
<dt>
<code>
id: <Link to="../iota-framework/object#0x2_object_UID">object::UID</Link></code>
</dt>
<dd>

</dd>
<dt>
<code>
denied_count: <Link to="../iota-framework/table#0x2_table_Table">table::Table</Link>&lt;<b>address</b>, u64&gt;</code>
</dt>
<dd>
 Number of object types that have been banned for a given address.
 Used to quickly skip checks for most addresses.
</dd>
<dt>
<code>
denied_addresses: <Link to="../iota-framework/table#0x2_table_Table">table::Table</Link>&lt;<Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;, <Link to="../iota-framework/vec_set#0x2_vec_set_VecSet">vec_set::VecSet</Link>&lt;<b>address</b>&gt;&gt;</code>
</dt>
<dd>
 Set of addresses that are banned for a given type.
 For example with <code>
iota::coin::Coin</code>: If addresses A and B are banned from using
 "0...0123::my_coin::MY_COIN", this will be "0...0123::my_coin::MY_COIN" -> \{A, B}.
</dd>
</dl>


</details>

<Link id="@Constants_0"></Link>

## Constants


<Link id="0x2_deny_list_ENotSystemAddress"></Link>

Trying to create a deny list object when not called by the system address.


<pre><code>
<b>const</b> <Link to="../iota-framework/deny_list#0x2_deny_list_ENotSystemAddress">ENotSystemAddress</Link>: u64 = 0;
</code></pre>



<Link id="0x2_deny_list_COIN_INDEX"></Link>

The index into the deny list vector for the <code>
iota::coin::Coin</code> type.


<pre><code>
<b>const</b> <Link to="../iota-framework/deny_list#0x2_deny_list_COIN_INDEX">COIN_INDEX</Link>: u64 = 0;
</code></pre>



<Link id="0x2_deny_list_ENotDenied"></Link>

The specified address to be removed is not already in the deny list.


<pre><code>
<b>const</b> <Link to="../iota-framework/deny_list#0x2_deny_list_ENotDenied">ENotDenied</Link>: u64 = 1;
</code></pre>



<Link id="0x2_deny_list_add"></Link>

## Function `add`

Adds the given address to the deny list of the specified type, preventing it
from interacting with instances of that type as an input to a transaction. For coins,
the type specified is the type of the coin, not the coin type itself. For example,
"00...0123::my_coin::MY_COIN" would be the type, not "00...02::coin::Coin".


<pre><code>
<b>public</b>(<b>friend</b>) <b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_add">add</Link>(<Link to="../iota-framework/deny_list#0x2_deny_list">deny_list</Link>: &<b>mut</b> <Link to="../iota-framework/deny_list#0x2_deny_list_DenyList">deny_list::DenyList</Link>, per_type_index: u64, type: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;, addr: <b>address</b>)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b>(package) <b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_add">add</Link>(
    <Link to="../iota-framework/deny_list#0x2_deny_list">deny_list</Link>: &<b>mut</b> <Link to="../iota-framework/deny_list#0x2_deny_list_DenyList">DenyList</Link>,
    per_type_index: u64,
    `type`: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;,
    addr: <b>address</b>,
) \{
    <b>let</b> bag_entry: &<b>mut</b> <Link to="../iota-framework/deny_list#0x2_deny_list_PerTypeList">PerTypeList</Link> = &<b>mut</b> <Link to="../iota-framework/deny_list#0x2_deny_list">deny_list</Link>.lists[per_type_index];
    bag_entry.<Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list_add">per_type_list_add</Link>(`type`, addr)
}
</code></pre>



</details>

<Link id="0x2_deny_list_per_type_list_add"></Link>

## Function `per_type_list_add`



<pre><code>
<b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list_add">per_type_list_add</Link>(list: &<b>mut</b> <Link to="../iota-framework/deny_list#0x2_deny_list_PerTypeList">deny_list::PerTypeList</Link>, type: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;, addr: <b>address</b>)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list_add">per_type_list_add</Link>(
    list: &<b>mut</b> <Link to="../iota-framework/deny_list#0x2_deny_list_PerTypeList">PerTypeList</Link>,
    `type`: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;,
    addr: <b>address</b>,
) \{
    <b>if</b> (!list.denied_addresses.<Link to="../iota-framework/deny_list#0x2_deny_list_contains">contains</Link>(`type`)) \{
        list.denied_addresses.<Link to="../iota-framework/deny_list#0x2_deny_list_add">add</Link>(`type`, <Link to="../iota-framework/vec_set#0x2_vec_set_empty">vec_set::empty</Link>());
    };
    <b>let</b> denied_addresses = &<b>mut</b> list.denied_addresses[`type`];
    <b>let</b> already_denied = denied_addresses.<Link to="../iota-framework/deny_list#0x2_deny_list_contains">contains</Link>(&addr);
    <b>if</b> (already_denied) <b>return</b>;

    denied_addresses.insert(addr);
    <b>if</b> (!list.denied_count.<Link to="../iota-framework/deny_list#0x2_deny_list_contains">contains</Link>(addr)) \{
        list.denied_count.<Link to="../iota-framework/deny_list#0x2_deny_list_add">add</Link>(addr, 0);
    };
    <b>let</b> denied_count = &<b>mut</b> list.denied_count[addr];
    *denied_count = *denied_count + 1;
}
</code></pre>



</details>

<Link id="0x2_deny_list_remove"></Link>

## Function `remove`

Removes a previously denied address from the list.
Aborts with <code>
<Link to="../iota-framework/deny_list#0x2_deny_list_ENotDenied">ENotDenied</Link></code> if the address is not on the list.


<pre><code>
<b>public</b>(<b>friend</b>) <b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_remove">remove</Link>(<Link to="../iota-framework/deny_list#0x2_deny_list">deny_list</Link>: &<b>mut</b> <Link to="../iota-framework/deny_list#0x2_deny_list_DenyList">deny_list::DenyList</Link>, per_type_index: u64, type: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;, addr: <b>address</b>)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b>(package) <b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_remove">remove</Link>(
    <Link to="../iota-framework/deny_list#0x2_deny_list">deny_list</Link>: &<b>mut</b> <Link to="../iota-framework/deny_list#0x2_deny_list_DenyList">DenyList</Link>,
    per_type_index: u64,
    `type`: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;,
    addr: <b>address</b>,
) \{
    <Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list_remove">per_type_list_remove</Link>(&<b>mut</b> <Link to="../iota-framework/deny_list#0x2_deny_list">deny_list</Link>.lists[per_type_index], `type`, addr)
}
</code></pre>



</details>

<Link id="0x2_deny_list_per_type_list_remove"></Link>

## Function `per_type_list_remove`



<pre><code>
<b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list_remove">per_type_list_remove</Link>(list: &<b>mut</b> <Link to="../iota-framework/deny_list#0x2_deny_list_PerTypeList">deny_list::PerTypeList</Link>, type: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;, addr: <b>address</b>)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list_remove">per_type_list_remove</Link>(
    list: &<b>mut</b> <Link to="../iota-framework/deny_list#0x2_deny_list_PerTypeList">PerTypeList</Link>,
    `type`: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;,
    addr: <b>address</b>,
) \{
    <b>let</b> denied_addresses = &<b>mut</b> list.denied_addresses[`type`];
    <b>assert</b>!(denied_addresses.<Link to="../iota-framework/deny_list#0x2_deny_list_contains">contains</Link>(&addr), <Link to="../iota-framework/deny_list#0x2_deny_list_ENotDenied">ENotDenied</Link>);
    denied_addresses.<Link to="../iota-framework/deny_list#0x2_deny_list_remove">remove</Link>(&addr);
    <b>let</b> denied_count = &<b>mut</b> list.denied_count[addr];
    *denied_count = *denied_count - 1;
    <b>if</b> (*denied_count == 0) \{
        list.denied_count.<Link to="../iota-framework/deny_list#0x2_deny_list_remove">remove</Link>(addr);
    }
}
</code></pre>



</details>

<Link id="0x2_deny_list_contains"></Link>

## Function `contains`

Returns true iff the given address is denied for the given type.


<pre><code>
<b>public</b>(<b>friend</b>) <b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_contains">contains</Link>(<Link to="../iota-framework/deny_list#0x2_deny_list">deny_list</Link>: &<Link to="../iota-framework/deny_list#0x2_deny_list_DenyList">deny_list::DenyList</Link>, per_type_index: u64, type: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;, addr: <b>address</b>): bool
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b>(package) <b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_contains">contains</Link>(
    <Link to="../iota-framework/deny_list#0x2_deny_list">deny_list</Link>: &<Link to="../iota-framework/deny_list#0x2_deny_list_DenyList">DenyList</Link>,
    per_type_index: u64,
    `type`: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;,
    addr: <b>address</b>,
): bool \{
    <Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list_contains">per_type_list_contains</Link>(&<Link to="../iota-framework/deny_list#0x2_deny_list">deny_list</Link>.lists[per_type_index], `type`, addr)
}
</code></pre>



</details>

<Link id="0x2_deny_list_per_type_list_contains"></Link>

## Function `per_type_list_contains`



<pre><code>
<b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list_contains">per_type_list_contains</Link>(list: &<Link to="../iota-framework/deny_list#0x2_deny_list_PerTypeList">deny_list::PerTypeList</Link>, type: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;, addr: <b>address</b>): bool
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list_contains">per_type_list_contains</Link>(
    list: &<Link to="../iota-framework/deny_list#0x2_deny_list_PerTypeList">PerTypeList</Link>,
    `type`: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;u8&gt;,
    addr: <b>address</b>,
): bool \{
    <b>if</b> (!list.denied_count.<Link to="../iota-framework/deny_list#0x2_deny_list_contains">contains</Link>(addr)) <b>return</b> <b>false</b>;

    <b>let</b> denied_count = &list.denied_count[addr];
    <b>if</b> (*denied_count == 0) <b>return</b> <b>false</b>;

    <b>if</b> (!list.denied_addresses.<Link to="../iota-framework/deny_list#0x2_deny_list_contains">contains</Link>(`type`)) <b>return</b> <b>false</b>;

    <b>let</b> denied_addresses = &list.denied_addresses[`type`];
    denied_addresses.<Link to="../iota-framework/deny_list#0x2_deny_list_contains">contains</Link>(&addr)
}
</code></pre>



</details>

<Link id="0x2_deny_list_create"></Link>

## Function `create`

Creation of the deny list object is restricted to the system address
via a system transaction.


<pre><code>
<b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_create">create</Link>(ctx: &<b>mut</b> <Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_create">create</Link>(ctx: &<b>mut</b> TxContext) \{
    <b>assert</b>!(ctx.sender() == @0x0, <Link to="../iota-framework/deny_list#0x2_deny_list_ENotSystemAddress">ENotSystemAddress</Link>);

    <b>let</b> <b>mut</b> lists = <Link to="../iota-framework/bag#0x2_bag_new">bag::new</Link>(ctx);
    lists.<Link to="../iota-framework/deny_list#0x2_deny_list_add">add</Link>(<Link to="../iota-framework/deny_list#0x2_deny_list_COIN_INDEX">COIN_INDEX</Link>, <Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list">per_type_list</Link>(ctx));
    <b>let</b> deny_list_object = <Link to="../iota-framework/deny_list#0x2_deny_list_DenyList">DenyList</Link> \{
        id: <Link to="../iota-framework/object#0x2_object_iota_deny_list_object_id">object::iota_deny_list_object_id</Link>(),
        lists,
    };
    <Link to="../iota-framework/transfer#0x2_transfer_share_object">transfer::share_object</Link>(deny_list_object);
}
</code></pre>



</details>

<Link id="0x2_deny_list_per_type_list"></Link>

## Function `per_type_list`



<pre><code>
<b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list">per_type_list</Link>(ctx: &<b>mut</b> <Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>): <Link to="../iota-framework/deny_list#0x2_deny_list_PerTypeList">deny_list::PerTypeList</Link>
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>fun</b> <Link to="../iota-framework/deny_list#0x2_deny_list_per_type_list">per_type_list</Link>(ctx: &<b>mut</b> TxContext): <Link to="../iota-framework/deny_list#0x2_deny_list_PerTypeList">PerTypeList</Link> \{
    <Link to="../iota-framework/deny_list#0x2_deny_list_PerTypeList">PerTypeList</Link> \{
        id: <Link to="../iota-framework/object#0x2_object_new">object::new</Link>(ctx),
        denied_count: <Link to="../iota-framework/table#0x2_table_new">table::new</Link>(ctx),
        denied_addresses: <Link to="../iota-framework/table#0x2_table_new">table::new</Link>(ctx),
    }
}
</code></pre>



</details>
